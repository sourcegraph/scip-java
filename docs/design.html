<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Design · lsif-java</title><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="generator" content="Docusaurus"/><meta name="description" content="This project is implemented as a"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Design · lsif-java"/><meta property="og:type" content="website"/><meta property="og:url" content="https://sourcegraph.github.io/lsif-java/lsif-java/index.html"/><meta property="og:description" content="This project is implemented as a"/><meta property="og:image" content="https://sourcegraph.github.io/lsif-java/lsif-java/img/lsif-java.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://sourcegraph.github.io/lsif-java/lsif-java/img/lsif-java.png"/><link rel="shortcut icon" href="/lsif-java/img/favicon.ico"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css"/><link rel="stylesheet" href="/lsif-java/css/custom.css"/><script src="/lsif-java/js/scrollSpy.js"></script><link rel="stylesheet" href="/lsif-java/css/prism.css"/><link rel="stylesheet" href="/lsif-java/css/main.css"/><script src="/lsif-java/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/lsif-java/"><img class="logo" src="/lsif-java/img/lsif-java.png" alt="lsif-java"/><h2 class="headerTitleWithLogo">lsif-java</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/lsif-java/docs/getting-started.html" target="_self">Docs</a></li><li class=""><a href="https://github.com/sourcegraph/lsif-java" target="_blank">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Contributing</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Using</h3><ul class=""><li class="navListItem"><a class="navItem" href="/lsif-java/docs/getting-started.html">Getting started</a></li><li class="navListItem"><a class="navItem" href="/lsif-java/docs/manual-configuration.html">Manual configuration</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Contributing</h3><ul class=""><li class="navListItem"><a class="navItem" href="/lsif-java/docs/contributing.html">Guide</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/lsif-java/docs/design.html">Design</a></li><li class="navListItem"><a class="navItem" href="/lsif-java/docs/benchmarks.html">Benchmarks</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/sourcegraph/lsif-java/edit/main/docs/design.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 id="__docusaurus" class="postHeaderTitle">Design</h1></header><article><div><span><p>This project is implemented as a
<a href="https://docs.oracle.com/en/java/javase/11/docs/api/jdk.compiler/com/sun/source/util/Plugin.html">Java compiler plugin</a>
that generates one
<a href="https://scalameta.org/docs/semanticdb/specification.html">SemanticDB</a> file for
every <code>*.java</code> source file. After compilation completes, the SemanticDB files
are processed to produce LSIF.</p>
<p><img src="/lsif-java/docs/assets/semanticdb-javac-pipeline.svg" alt="A three stage pipeline that starts with a list of Java sources, creates a list of SemanticDB files that then become a single LSIF index."></p>
<h3><a class="anchor" aria-hidden="true" id="why-java-compiler-plugin"></a><a href="#why-java-compiler-plugin" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Why Java compiler plugin?</h3>
<p>There are several benefits to implementing lsif-java as a compiler plugin:</p>
<ul>
<li><strong>Simple installation</strong>: compiler plugins are enabled with the <code>-Xplugin</code>
compiler option. All Java build tools support a way to customize compiler
options, simplifying installation.</li>
<li><strong>Language fidelity</strong>: by using the Java compiler to produce semantic
information, we ensure that the produced LSIF data is accurate even as new
Java language versions with new language features are released.</li>
<li><strong>Environment fidelity</strong>: by hooking into the compilation process of the build
tool, we minimize the risk of diverging from the CI build environment such as
installed system dependencies, custom compiler options and custom annotation
processors.</li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="why-semanticdb"></a><a href="#why-semanticdb" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Why SemanticDB?</h3>
<p>SemanticDB is Protobuf schema for information about symbols and types in Java
programs, Scala programs and other languages. There are several benefits to
using SemanticDB as an intermediary representation for LSIF:</p>
<ul>
<li><strong>Simplicity</strong>: It's easy to translate a single Java source file into a single
SemanticDB file inside a compiler plugin. It's more complicated to produce
LSIF because compiler plugins does not have access to a project-wide context,
which is necessary to produce accurate definitions and hovers in multi-module
projects with external library dependencies.</li>
<li><strong>Performance</strong>: SemanticDB is fast to write and read. Each compilation unit
can be processed independently to keep memory usage low. The final conversion
from SemanticDB to LSIF can be safely parallelized.</li>
<li><strong>Cross-language</strong>: SemanticDB has a
<a href="https://scalameta.org/docs/semanticdb/specification.html">spec</a> for Java and
Scala enabling cross-language navigation in hybrid Java/Scala codebases.</li>
<li><strong>Cross-repository</strong>: Compiler plugins have access to both source code and the
classpath (compiled bytecode of upstream dependencies). SemanticDB has been
designed so that it's also possible to generate spec-compliant symbols from
the classpath alone (no source code) and from the syntax tree of an individual
source file (no classpath). This flexibility allows the
<a href="https://scalameta.org/metals/">Metals</a> language server to index codebases
from a variety of different inputs, and will be helpful for lsif-java in the
future to unblock cross-repository navigation.</li>
</ul>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/lsif-java/docs/contributing.html"><span class="arrow-prev">← </span><span>Guide</span></a><a class="docs-next button" href="/lsif-java/docs/benchmarks.html"><span>Benchmarks</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"></nav></div><footer class="nav-footer" id="footer" style="background-color:#664100"><section class="sitemap"><a href="/lsif-java/" class="nav-home"><img src="/lsif-java/img/lsif-java.png" alt="lsif-java" width="66" height="58"/></a><div><h5>Docs</h5><a href="/lsif-java/docs/installation.html">Get started</a></div><div><h5>Community</h5><a target="_blank">Chat on Gitter</a></div><div><h5>More</h5><a href="https://github.com/sourcegraph/lsif-java" target="_blank">GitHub</a></div></section><section class="copyright">Copyright © 2022 lsif-java developers</section></footer></div></body></html>